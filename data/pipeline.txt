- Literature review. Get all substrate entry ID

- Clean the data: check redundance & Check if cleavage logo is in the sequence
- Check if the nonsub & sub share the same entry

- Extract the uniprot information (gene name, etc)
- Generate formal cleavage logo (xxxxx/xxxxx) & sites

- Match the human entry ID for mouse entry ID, get final entry ID

            globle alignment with BLOSUM62, no gap penalty
            score_percentage = (alignment.score / max_possible_score) * 100
            70% score percentage as threshold
            
            # set the threshold standard based on BLOSUM62
            # 30-50%: distal homology
            # 50-70%: medium homology
            # >70%: proximal homology

- Align the cleavage logo to get the final cleavage sites

            local alignment:
            match score: 2
            mismatch penalty: -1
            gap open penalty: -0.5
            gap extension penalty: -0.1

            Idendity = (matches / aligned_length) * 100 if aligned_length > 0 else 0
            # matches: the same aligned aa
            # aligned_length: total aligned aa acount = 12aa

            # lowest ADAM17 sub identity obtained: 87.5%

- Reduce the redundance for final entry!!! & check if the nonsub & sub share the same entry!!
- Delete the final entries if the score_percentage is lower 70%

- Download batch fasta data

''' NOW ALL THE PROTEIN SHOULD BE HUMAN PROTEIN!!!'''

- Extract the topology information (TOPCONS, TMHMM) & protein type information (type I/II, etc.)
    # Check the transmenbrane information, could be possible that multiple pass occur.
- Asign dataset

- Structural analysis with ProVis


- Process the reference dataset
    # Extract domain info from UniProt/TMHMM/TOPCONS
    # Delete the gene which is not TMP (from uniprot or TMHMM)
    # Assign dataset (check the transmenbrane domain, if multiple pass or empty in UniProt annotation, delete)

- prepare the df_seq for cd-hit 
    # Relabel: sub: 1; nonsub: 0; ref: 2


- Run CD-Hit (same to stephan, 40%-similarity cut-off):
        Number of CD-HIT clusters: 736

        # Ref (Type_I_TMP HUMAN)
        Number of CD-HIT clusters: 736
        Number of entries: 1052

        # ADAM17 sub (Type_I_TMP HUMAN)
        Number of CD-HIT clusters: 91
        Number of entries: 100

        # ADAM17 nonsub (Type_I_TMP HUMAN)
        Number of CD-HIT clusters: 13
        Number of entries: 11
    - Filter cd-hit clusters
    - Assign labels_cpp_all (sub is test: 1; nonsub+ref is ref: 0)
    - Assign labels_all (sub: 1; nonsub: 0; ref: 2)


# Type I proteins have the N terminus on the extracellular side and the C terminus on the cytosolic side. (N-out)


- Run CPP:
        - obtain scale set (initially all 586 scales, reduce to 133 scales, need to be tunned)
        - Run sub (test) against ref (ref)
        - Use the same features for nonsub

- Run dPULearn:
        - input: sub/ref: 1/2
        - output: nonsub_dpu/sub/ref: 0/1/2

- Find dPULearn added nonsub and assign to 3:
        # nonsub_dpu/sub/ref/dpu: 0/1/2/3






